(function(e){function t(t){for(var a,i,o=t[0],l=t[1],c=t[2],d=0,v=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&v.push(s[i][0]),s[i]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);u&&u(t);while(v.length)v.shift()();return n.push.apply(n,c||[]),r()}function r(){for(var e,t=0;t<n.length;t++){for(var r=n[t],a=!0,o=1;o<r.length;o++){var l=r[o];0!==s[l]&&(a=!1)}a&&(n.splice(t--,1),e=i(i.s=r[0]))}return e}var a={},s={app:0},n=[];function i(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=a,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(r,a,function(t){return e[t]}.bind(null,a));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/crux/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;n.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",[r("v-app-bar",{attrs:{app:"",color:"primary",dark:""}},[r("v-toolbar-title",{staticClass:"display-1"},[e._v("Open Client Registry")]),r("v-spacer"),r("v-toolbar-items",[e.$store.state.denyAccess?e._e():r("v-btn",{attrs:{color:"primary",to:"/"}},[r("v-icon",[e._v("mdi-home")]),e._v(" Home ")],1),e.$store.state.denyAccess?e._e():r("v-btn",{attrs:{color:"primary",to:"/addUser"}},[r("v-icon",[e._v("mdi-account-plus")]),e._v(" Add User ")],1),e.$store.state.denyAccess?e._e():r("v-btn",{attrs:{color:"primary",to:"/logout"}},[r("v-icon",[e._v("mdi-logout")]),e._v(" Logout ")],1)],1),r("v-spacer")],1),r("v-content",[r("center",[r("v-alert",{style:{width:e.$store.state.alert.width},attrs:{type:e.$store.state.alert.type,dismissible:e.$store.state.alert.dismisible,transition:e.$store.state.alert.transition},model:{value:e.$store.state.alert.show,callback:function(t){e.$set(e.$store.state.alert,"show",t)},expression:"$store.state.alert.show"}},[e._v(" "+e._s(e.$store.state.alert.msg)+" ")])],1),r("router-view")],1)],1)},n=[],i=r("2b27"),o=r.n(i),l=r("bc3a"),c=r.n(l),u={name:"App",data:function(){return{}},created:function(){var e=this;o.a.get("token")&&o.a.get("userID")&&(this.$store.state.auth.token=o.a.get("token"),this.$store.state.auth.userID=o.a.get("userID"),this.$store.state.auth.username=o.a.get("username"),c.a.get("/ocrux/isTokenActive/").then((function(t){e.$store.state.denyAccess=!1,c.a.get("/ocrux/getURI").then((function(t){e.$store.state.systemURI=t.data})).catch((function(e){console.log(e)})),c.a.get("/ocrux/getClients").then((function(t){e.$store.state.clients=t.data})).catch((function(e){console.log(e)}))})))}},d=u,v=r("2877"),h=r("6544"),m=r.n(h),p=r("0798"),f=r("7496"),y=r("40dc"),_=r("8336"),b=r("a75b"),g=r("132d"),k=r("2fa4"),x=r("2a7f"),w=Object(v["a"])(d,s,n,!1,null,null,null),$=w.exports;m()(w,{VAlert:p["a"],VApp:f["a"],VAppBar:y["a"],VBtn:_["a"],VContent:b["a"],VIcon:g["a"],VSpacer:k["a"],VToolbarItems:x["a"],VToolbarTitle:x["b"]});var C=r("8c4f"),V=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",[r("v-card-title",[e._v(" Client Registry "),r("v-spacer"),r("v-text-field",{attrs:{label:"Search Surname","hide-details":"",outlined:"",shaped:"",clearable:""},on:{change:function(t){return e.searchData()}},model:{value:e.search_family,callback:function(t){e.search_family=t},expression:"search_family"}}),r("v-text-field",{attrs:{label:"Search Given Name(s)","hide-details":"",outlined:"",shaped:"",clearable:""},on:{change:function(t){return e.searchData()}},model:{value:e.search_given,callback:function(t){e.search_given=t},expression:"search_given"}}),r("v-text-field",{attrs:{label:"Exact CRUID","hide-details":"",outlined:"",shaped:"",clearable:""},on:{change:function(t){return e.searchData()}},model:{value:e.search_uid,callback:function(t){e.search_uid=t},expression:"search_uid"}})],1),r("v-data-table",{staticClass:"elevation-1",staticStyle:{cursor:"pointer"},attrs:{headers:e.headers,items:e.patients,options:e.options,"server-items-length":e.totalPatients,"footer-props":{"items-per-page-options":[5,10,20,50]},loading:e.loading},on:{"update:options":function(t){e.options=t},"click:row":e.clickIt}})],1)},E=[],R=(r("a4d3"),r("e01a"),r("d28b"),r("7db0"),r("a15b"),r("b0c0"),r("d3b7"),r("ac1f"),r("3ca3"),r("5319"),r("9911"),r("ddb0"),{name:"Home",data:function(){return{debug:"",search_family:"",search_given:"",search_uid:"",search_terms:[],loading:!1,totalPatients:0,prevPage:-1,link:[],options:{itemsPerPage:10,sortBy:["family"]},rowsPerPageItems:[5,10,20,50],headers:[{text:"Surname",value:"family"},{text:"Given Name(s)",value:"given"},{text:"NIN",value:"nin",sortable:!1},{text:"Gender",value:"gender"},{text:"Birth Date",value:"birthdate"},{text:"CRUID",value:"uid",sortable:!1}],patients:[]}},watch:{options:{handler:function(){this.getData()},deep:!0}},mounted:function(){this.getData()},methods:{clickIt:function(e){this.$router.push({name:"client",params:{clientId:e.id}})},searchData:function(){this.search_terms=[],this.search_family&&this.search_terms.push("family:contains="+encodeURIComponent(this.search_family)),this.search_given&&this.search_terms.push("given:contains="+encodeURIComponent(this.search_given)),this.search_uid&&this.search_terms.push("link="+encodeURIComponent(this.search_uid)),this.getData(!0)},getData:function(e){var t=this;this.loading=!0;var r="";if(e&&(this.options.page=1),this.options.page>1&&(this.options.page===this.prevPage-1?r=this.link.find((function(e){return"previous"===e.relation})).url:this.options.page===this.prevPage+1&&(r=this.link.find((function(e){return"next"===e.relation})).url),r=r.replace("http://localhost:8081/clientregistry","")),""===r){var a=this.options.itemsPerPage||10,s="";for(var n in this.options.sortBy)s&&(s+=","),this.options.sortDesc[n]&&(s+="-"),s+=this.options.sortBy[n];r="/ocrux/fhir/Patient?_count="+a+"&_total=accurate&_tag:not=5c827da5-4858-4f3d-a50c-62ece001efea",this.search_terms.length>0&&(r+="&"+this.search_terms.join("&")),this.debug=r}this.prevPage=this.options.page,this.$http.get(r).then((function(e){if(t.patients=[],e.data.total>0){t.link=e.data.link;var r=!0,a=!1,s=void 0;try{for(var n,i=e.data.entry[Symbol.iterator]();!(r=(n=i.next()).done);r=!0){var o=n.value;if(!(!o.resource.link||o.resource.link&&Array.isArray(o.resource.link)&&0===o.resource.link.length||o.resource.link&&!Array.isArray(o.resource.link))){var l=o.resource.name&&o.resource.name.find((function(e){return"official"===e.use}));l||(l={});var c=o.resource.identifier.find((function(e){return e.system===Object({NODE_ENV:"production",VUE_APP_CRUID_TAG:"5c827da5-4858-4f3d-a50c-62ece001efea",VUE_APP_BROKEN_MATCH_URL:"http://clientregistry.org/brokenMatch",VUE_APP_FHIR_ROOT:"http://localhost:8081/clientregistry",VUE_APP_BACKEND_SERVER:"https://localhost:3000/OCRUX",BASE_URL:"/crux/"}).VUE_APP_SYSTEM_NIN}));c||(c={}),t.patients.push({id:o.resource.id,family:l.family,given:l.given,birthdate:o.resource.birthDate,gender:o.resource.gender,nin:c.value,uid:o.resource.link[0].other.reference.replace("Patient/","")})}}}catch(u){a=!0,s=u}finally{try{r||null==i.return||i.return()}finally{if(a)throw s}}}t.totalPatients=e.data.total,t.loading=!1}))}}}),P=R,S=r("b0af"),D=r("99d9"),A=r("8fea"),I=r("8654"),U=Object(v["a"])(P,V,E,!1,null,null,null),N=U.exports;m()(U,{VCard:S["a"],VCardTitle:D["c"],VDataTable:A["a"],VSpacer:k["a"],VTextField:I["a"]});var B=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-row",[r("v-col",{attrs:{cols:"6"}},[r("v-card",{staticClass:"mx-auto"},[r("v-carousel",{attrs:{"show-arrows-on-hover":!0},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},e._l(e.match_items,(function(t,a){return r("v-carousel-item",{key:a+"-"+t.id},[r("v-card",{staticClass:"mx-auto",attrs:{height:"100%"}},[r("v-toolbar",{attrs:{color:"secondary",dark:""}},[r("v-toolbar-title",{staticClass:"font-weight-bold"},[e._v(" CRUID: "+e._s(e.uid)+" ")]),r("v-spacer"),e._v(" "+e._s(e.selected+1)+" / "+e._s(e.match_count)+" ")],1),r("v-list",{attrs:{dense:"",light:"",height:"100%"}},[r("v-list-item",[r("v-list-item-content",[e._v("Submitting System:")]),r("v-list-item-content",{staticClass:"align-end"},[e._v(" "+e._s(t.system)+" ")])],1),e._l(t.name,(function(t,a){return r("v-list-item",{key:a+"-"+t.use},[r("v-list-item-content",[e._v("Name ("+e._s(t.use)+")")]),r("v-list-item-content",{staticClass:"align-end text-capitalize"},[e._v(" "+e._s(t.given.join(" "))+" "+e._s(t.family)+" ")])],1)})),r("v-list-item",[r("v-list-item-content",[e._v("Gender:")]),r("v-list-item-content",{staticClass:"align-end"},[e._v(" "+e._s(t.gender)+" ")])],1),r("v-list-item",[r("v-list-item-content",[e._v("Birth Date:")]),r("v-list-item-content",{staticClass:"align-end"},[e._v(" "+e._s(t.birthdate)+" ")])],1),e._l(t.telecom,(function(t,a){return r("v-list-item",{key:a+"-"+t.system},[r("v-list-item-content",{staticClass:"text-capitalize"},[e._v(" "+e._s(t.system)+": ")]),r("v-list-item-content",{staticClass:"align-end"},[e._v(" "+e._s(t.value)+" ")])],1)})),e._l(t.identifier,(function(t,a){return r("v-list-item",{key:a+"-"+t.system},[r("v-list-item-content",[e._v(e._s(t.name)+":")]),r("v-list-item-content",{staticClass:"align-end"},[e._v(" "+e._s(t.value)+" ")])],1)}))],2)],1)],1)})),1),r("v-list",{staticClass:"info",attrs:{"two-lines":"",dark:""}},[r("v-list-item",[r("v-list-item-content"),r("v-list-item-action",[r("router-link",{attrs:{to:"/",tag:"button"}},[e._v(" Home ")])],1)],1)],1)],1)],1),r("v-col",{attrs:{cols:"6"}},[r("v-card",{staticClass:"mx-auto"},[r("v-toolbar",{attrs:{color:"accent",dark:""}},[r("v-toolbar-title",[e._v("Matched Records")])],1),r("v-data-table",{staticClass:"elevation-1 text-capitalize",attrs:{headers:e.match_headers,items:e.match_items,"items-per-page":20,"item-key":"id","show-select":""},model:{value:e.breaks,callback:function(t){e.breaks=t},expression:"breaks"}}),r("v-card-actions",[r("v-spacer"),r("v-btn",{staticClass:"warning",attrs:{disabled:0===e.breaks.length||e.match_items.length<2},on:{click:function(t){return e.breakMatch()}}},[e._v(" Break Match(es) ")])],1)],1)],1),r("v-col",{attrs:{cols:"12"}},[r("v-card",{staticClass:"mx-auto"},[r("v-toolbar",{attrs:{color:"warning",dark:""}},[r("v-toolbar-title",[e._v("Broken Matches")])],1),r("v-data-table",{staticClass:"elevation-1 text-capitalize",attrs:{headers:e.match_headers,items:e.break_items,"items-per-page":20,"item-key":"id","show-select":""},model:{value:e.unbreaks,callback:function(t){e.unbreaks=t},expression:"unbreaks"}}),r("v-card-actions",[r("v-spacer"),r("v-btn",{staticClass:"accent",attrs:{disabled:0===e.unbreaks.length},on:{click:function(t){return e.revertBreak()}}},[e._v(" Revert Break ")])],1)],1)],1),r("v-col",{attrs:{cols:"12"}},[r("v-card",{staticClass:"mx-auto"},[r("v-toolbar",{attrs:{color:"secondary",dark:""}},[r("v-toolbar-title",[e._v("History")])],1),r("v-expansion-panels",{attrs:{popout:""}},e._l(e.matchEvents,(function(t,a){return r("v-expansion-panel",{key:a},[r("v-expansion-panel-header",["submittedResource"===t.type?[e._v(" Submitted Resource ")]:e._e(),"breakMatch"===t.type?[e._v(" Break Match ")]:e._e(),"unBreak"===t.type?[e._v(" Revert Break ")]:e._e(),e._v(" Event "+e._s(e._f("moment")(t.recorded,"Do MMM YYYY h:mm:ss a")))],2),r("v-expansion-panel-content",["submittedResource"!==t.type?[e._v(" User: "+e._s(t.username)+" "),r("br")]:e._e(),e._v(" Operation: "),r("b",[e._v(e._s(t.operation))]),e._v(" "),r("br"),e._v(" Operation Time "+e._s(e._f("moment")(t.recorded,"Do MMM YYYY h:mm:ss a"))+" "),r("br"),e._v(" Status: "),"0"===t.outcomeCode?[r("v-chip",{attrs:{color:"green",dark:""}},[e._v(" "+e._s(t.outcome)+" ")])]:[r("v-chip",{attrs:{color:"red",dark:""}},[e._v(" "+e._s(t.outcome)+" ")])],r("br"),e._v(" IP Address: "+e._s(t.ipaddress)+" "),r("br"),"breakMatch"===t.type?r("v-row",[r("v-col",{attrs:{cols:"4"}},[r("v-card",{attrs:{elevation:"12",color:"green",hover:""}},[r("v-card-text",{staticClass:"white--text"},[e._v(" Break "),r("br"),r("b",[e._v(e._s(t.break))])])],1)],1),r("v-col",{attrs:{cols:"4"}},[r("v-card",{attrs:{elevation:"12",color:"red",hover:""}},[r("v-card-text",{staticClass:"white--text"},[e._v(" Old CRUID "),r("br"),r("b",[e._v(e._s(t.CRUID))])])],1)],1),r("v-col",{attrs:{cols:"4"}},[r("v-card",{attrs:{elevation:"12",color:"red",hover:""}},[r("v-card-text",{staticClass:"white--text"},[e._v(" Broken From "),r("br"),r("b",[e._l(t.breakFrom,(function(t){return[e._v(" => "+e._s(t)+" ")]}))],2)])],1)],1)],1):e._e(),"unBreak"===t.type?r("v-row",[r("v-col",{attrs:{cols:"4"}},[r("v-card",{attrs:{elevation:"12",color:"green",hover:""}},[r("v-card-text",{staticClass:"white--text"},[e._v(" Reverting "),r("br"),r("b",[e._v(e._s(t.unBreak))])])],1)],1),r("v-col",{attrs:{cols:"4"}},[r("v-card",{attrs:{elevation:"12",color:"red",hover:""}},[r("v-card-text",{staticClass:"white--text"},[e._v(" Reverting From CRUID "),r("br"),r("b",[e._v(e._s(t.unBreakFromCRUID))])])],1)],1),r("v-col",{attrs:{cols:"4"}},[r("v-card",{attrs:{elevation:"12",color:"red",hover:""}},[r("v-card-text",{staticClass:"white--text"},[e._v(" Reverting From "),r("br"),r("b",[e._l(t.unBreakFrom,(function(t){return[e._v(" => "+e._s(t)+" ")]}))],2)])],1)],1)],1):e._l(t.matchData,(function(t,a){return r("v-row",{key:a},[r("v-col",{attrs:{cols:"6"}},[r("v-card",{attrs:{elevation:"12",hover:""}},[r("v-card-title",{attrs:{"primary-title":""}},[e._v(" Decision Rule "+e._s(++a)+" => Matching Type: "),r("b",[e._v(" "+e._s(t.matchingType))])]),r("v-card-text",[r("v-data-table",{attrs:{headers:e.matchRuleHeaders,items:t.decisionRule,"items-per-page":20,"item-key":"id"},scopedSlots:e._u([{key:"item.details",fn:function(a){var s=a.item;return[s.details.algorithm?[e._v(" Algorithm - "+e._s(s.details.algorithm)),r("br")]:e._e(),s.details.threshold?[e._v(" Threshold "),r("v-chip",{attrs:{color:"red",dark:""}},[e._v(" "+e._s(s.details.threshold)+" ")]),r("br")]:e._e(),"probabilistic"===t.matchingType?[r("b",[e._v("mValue")]),r("v-chip",{attrs:{color:"green",dark:""}},[e._v(" "+e._s(s.details.mValue)+" ")]),e._v(" "),r("b",[e._v("- uValue")]),r("v-chip",{attrs:{color:"blue",dark:""}},[e._v(" "+e._s(s.details.uValue)+" ")]),r("br")]:e._e(),s.details.fhirpath?[e._v(" FHIR Path - "+e._s(s.details.fhirpath)+" ")]:e._e(),r("br"),r("br")]}}],null,!0)})],1)],1)],1),r("v-col",{attrs:{cols:"6"}},[r("v-switch",{attrs:{label:"View Advanced Details"},model:{value:e.advancedView,callback:function(t){e.advancedView=t},expression:"advancedView"}}),e.advancedView?[r("v-card",[r("v-card-text",[r("v-textarea",{attrs:{filled:"",color:"deep-purple",label:"Elasticsearch Query",rows:"10",value:t.query}})],1)],1),r("v-card",[r("v-card-text",[r("v-textarea",{attrs:{filled:"",color:"deep-purple",label:"Elasticsearch Results",rows:"10",value:t.match}})],1)],1)]:e._e()],2)],1)}))],2)],1)})),1)],1)],1)],1)],1)},T=[],O=r("e4ce"),F=O["a"],q=r("5e66"),M=r("3e35"),j=r("cc20"),L=r("62ad"),H=r("a523"),Y=r("cd55"),G=r("49e2"),K=r("c865"),z=r("0393"),J=r("8860"),X=r("da13"),Q=r("1800"),W=r("5d23"),Z=r("0fd9"),ee=r("b73d"),te=r("a844"),re=r("71d9"),ae=Object(v["a"])(F,B,T,!1,null,null,null),se=ae.exports;m()(ae,{VBtn:_["a"],VCard:S["a"],VCardActions:D["a"],VCardText:D["b"],VCardTitle:D["c"],VCarousel:q["a"],VCarouselItem:M["a"],VChip:j["a"],VCol:L["a"],VContainer:H["a"],VDataTable:A["a"],VExpansionPanel:Y["a"],VExpansionPanelContent:G["a"],VExpansionPanelHeader:K["a"],VExpansionPanels:z["a"],VList:J["a"],VListItem:X["a"],VListItemAction:Q["a"],VListItemContent:W["a"],VRow:Z["a"],VSpacer:k["a"],VSwitch:ee["a"],VTextarea:te["a"],VToolbar:re["a"],VToolbarTitle:x["b"]});var ne=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-spacer"),r("v-flex",{attrs:{xs6:""}},[r("v-card",{staticClass:"mx-auto",staticStyle:{"max-width":"500px"}},[r("v-system-bar",{attrs:{color:"primary",dark:""}}),r("v-toolbar",{attrs:{color:"secondary",cards:"",dark:"",flat:""}},[r("v-card-title",{staticClass:"title font-weight-regular"},[e._v("Add New User")])],1),r("v-form",{ref:"form",staticClass:"pa-3 pt-4"},[r("v-text-field",{attrs:{required:"","error-messages":e.firstnameErrors,filled:"",color:"deep-purple",label:"First Name*"},on:{blur:function(t){return e.$v.firstName.$touch()},change:function(t){return e.$v.firstName.$touch()}},model:{value:e.firstName,callback:function(t){e.firstName=t},expression:"firstName"}}),r("v-text-field",{attrs:{filled:"",color:"deep-purple",label:"Middle Names"},model:{value:e.otherName,callback:function(t){e.otherName=t},expression:"otherName"}}),r("v-text-field",{attrs:{required:"","error-messages":e.surnameErrors,filled:"",color:"deep-purple",label:"Surname*"},on:{blur:function(t){return e.$v.surname.$touch()},change:function(t){return e.$v.surname.$touch()}},model:{value:e.surname,callback:function(t){e.surname=t},expression:"surname"}}),r("v-text-field",{attrs:{required:"","error-messages":e.usernameErrors,filled:"",color:"deep-purple",label:"Username*"},on:{blur:function(t){return e.$v.userName.$touch()},change:function(t){return e.$v.surname.$touch()}},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}}),r("v-text-field",{attrs:{required:"","error-messages":e.passwordErrors,type:"password",filled:"",color:"deep-purple",label:"Password*"},on:{blur:function(t){return e.$v.password.$touch()},change:function(t){return e.$v.password.$touch()}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),r("v-text-field",{attrs:{label:"Re-type Password*",required:"",type:"password",filled:"",color:"deep-purple","error-messages":e.retype_passwordErrors},on:{blur:function(t){return e.$v.retype_password.$touch()},change:function(t){return e.$v.retype_password.$touch()}},model:{value:e.retype_password,callback:function(t){e.retype_password=t},expression:"retype_password"}})],1),r("v-divider"),r("v-card-actions",[r("v-btn",{attrs:{text:""},on:{click:function(t){return e.$refs.form.reset()}}},[r("v-icon",[e._v("mdi-clear")]),e._v("Clear ")],1),r("v-spacer"),r("v-btn",{staticClass:"white--text",attrs:{depressed:"",disabled:e.$v.$invalid,color:"deep-purple accent-4"},on:{click:function(t){return e.addUser()}}},[r("v-icon",{attrs:{left:""}},[e._v(" mdi-language ")]),e._v("Add ")],1)],1)],1)],1),r("v-spacer")],1)],1)},ie=[],oe=r("b5ae"),le=(Object({NODE_ENV:"production",VUE_APP_CRUID_TAG:"5c827da5-4858-4f3d-a50c-62ece001efea",VUE_APP_BROKEN_MATCH_URL:"http://clientregistry.org/brokenMatch",VUE_APP_FHIR_ROOT:"http://localhost:8081/clientregistry",VUE_APP_BACKEND_SERVER:"https://localhost:3000/OCRUX",BASE_URL:"/crux/"}).BACKEND_SERVER,{validations:{userName:{required:oe["required"]},retype_password:{required:oe["required"]},password:{required:oe["required"]},firstName:{required:oe["required"]},surname:{required:oe["required"]}},data:function(){return{firstName:"",otherName:"",surname:"",userName:"",password:"",retype_password:""}},computed:{firstnameErrors:function(){var e=[];return this.$v.firstName.$dirty?(!this.$v.firstName.required&&e.push("First Name is required"),e):e},surnameErrors:function(){var e=[];return this.$v.surname.$dirty?(!this.$v.surname.required&&e.push("Surname is required"),e):e},usernameErrors:function(){var e=[];return this.$v.userName.$dirty?(!this.$v.userName.required&&e.push("Username is required"),e):e},passwordErrors:function(){var e=[];return this.$v.password.$dirty?(!this.$v.password.required&&e.push("Password is required"),e):e},retype_passwordErrors:function(){var e=[];return this.$v.retype_password.$dirty?(!this.$v.retype_password.required&&e.push("Re-type Password"),e):e}},methods:{addUser:function(){var e=this;if(this.password!==this.retype_password)return this.$store.state.dialogError=!0,this.$store.state.errorTitle="Error",void(this.$store.state.errorDescription="Password mismatch");this.$store.state.dynamicProgress=!0,this.$store.state.progressTitle="Saving User";var t=new FormData;t.append("firstName",this.firstName),t.append("otherName",this.otherName),t.append("password",this.password),t.append("userName",this.userName),t.append("surname",this.surname),c.a.post("/ocrux/addUser/",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){e.$store.state.alert.show=!0,e.$store.state.alert.width="500px",e.$store.state.alert.msg="User added successfully",e.$store.state.alert.type="success",e.$refs.form.reset()})).catch((function(t){e.$store.state.alert.show=!0,e.$store.state.alert.width="500px",e.$store.state.alert.msg="This user was not added, ensure userName is not used",e.$store.state.alert.type="error",console.log(t.response.data.error)}))}}}),ce=le,ue=r("ce7e"),de=r("0e8f"),ve=r("4bd4"),he=r("a722"),me=r("afd9"),pe=Object(v["a"])(ce,ne,ie,!1,null,null,null),fe=pe.exports;m()(pe,{VBtn:_["a"],VCard:S["a"],VCardActions:D["a"],VCardTitle:D["c"],VContainer:H["a"],VDivider:ue["a"],VFlex:de["a"],VForm:ve["a"],VIcon:g["a"],VLayout:he["a"],VSpacer:k["a"],VSystemBar:me["a"],VTextField:I["a"],VToolbar:re["a"]});var ye=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("center",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs3:""}}),r("v-flex",{attrs:{xs6:""}},[r("v-alert",{attrs:{type:"error",value:e.authStatus}},[e._v(" Authentication Failed ")])],1)],1),r("v-card",{attrs:{width:"430px",hover:""}},[r("v-card-title",{attrs:{"primary-title":""}},[r("v-toolbar",{staticStyle:{color:"white"},attrs:{color:"primary"}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs2:"","text-xs-left":""}},[r("v-icon",{attrs:{"x-large":"",color:"white"}},[e._v(" mdi-lock ")])],1),r("v-flex",{attrs:{xs9:"","text-xs-right":""}},[r("b",[e._v("Login")])])],1)],1)],1),r("v-card-text",[r("v-form",{ref:"form",staticClass:"pa-3 pt-4"},[r("v-text-field",{attrs:{required:"",filled:"",color:"deep-purple",label:"Username","error-messages":e.usernameErrors},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.authenticate()},blur:function(t){return e.$v.username.$touch()},change:function(t){return e.$v.username.$touch()}},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),r("v-text-field",{attrs:{required:"",filled:"",type:"password",color:"deep-purple",label:"Password","error-messages":e.passwordErrors},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.authenticate()},blur:function(t){return e.$v.password.$touch()},change:function(t){return e.$v.password.$touch()}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1),r("v-card-actions",[r("v-toolbar",[r("v-spacer"),r("v-btn",{staticClass:"white--text",attrs:{color:"primary",depressed:"",disabled:e.$v.$invalid},on:{click:function(t){return e.authenticate()}}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-lock-open-variant")]),e._v(" Login ")],1)],1)],1)],1)],1)],1)},_e=[],be={validations:{username:{required:oe["required"]},password:{required:oe["required"]}},data:function(){return{username:"",password:"",authStatus:!1}},methods:{authenticate:function(){var e=this,t=new FormData;t.append("username",this.username),t.append("password",this.password);var r={username:this.username,password:this.password};c()({method:"POST",url:"/ocrux/authenticate",params:r}).then((function(t){e.$store.state.auth.token=t.data.token,e.$store.state.auth.username=e.username,e.$store.state.auth.userID=t.data.userID,o.a.config("30d"),o.a.set("token",e.$store.state.auth.token,"infinity"),o.a.set("userID",e.$store.state.auth.userID,"infinity"),o.a.set("username",e.$store.state.auth.username,"infinity"),e.$store.state.auth.role=t.data.role,t.data.token?(e.$store.state.denyAccess=!1,e.$router.push({name:"home"})):e.authStatus=!0})).catch((function(e){e.hasOwnProperty("response")&&console.log(e.response.data.error)}))}},computed:{usernameErrors:function(){var e=[];return this.$v.username.$dirty?(!this.$v.username.required&&e.push("Username is required"),e):e},passwordErrors:function(){var e=[];return this.$v.password.$dirty?(!this.$v.password.required&&e.push("Password is required"),e):e}}},ge=be,ke=Object(v["a"])(ge,ye,_e,!1,null,null,null),xe=ke.exports;m()(ke,{VAlert:p["a"],VBtn:_["a"],VCard:S["a"],VCardActions:D["a"],VCardText:D["b"],VCardTitle:D["c"],VContainer:H["a"],VFlex:de["a"],VForm:ve["a"],VIcon:g["a"],VLayout:he["a"],VSpacer:k["a"],VTextField:I["a"],VToolbar:re["a"]});var we=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{"grid-list-xs":""}})},$e=[],Ce={mounted:function(){this.$store.state.auth.token="",o.a.remove("token"),o.a.remove("userID"),o.a.remove("role"),o.a.remove("username"),this.$router.push("login"),this.$store.state.denyAccess=!0}},Ve=Ce,Ee=Object(v["a"])(Ve,we,$e,!1,null,null,null),Re=Ee.exports;m()(Ee,{VContainer:H["a"]});var Pe=r("2f62");a["a"].use(Pe["a"]);var Se=new Pe["a"].Store({state:{clients:[],systemURI:{},auth:{username:"",userID:"",role:"",token:""},alert:{width:"800px",show:!1,msg:"",type:"success",dismisible:!0,transition:"scale-transition"},denyAccess:!0,dialogError:!1,errorTitle:"",errorDescription:"",errorColor:"primary",dynamicProgress:!1}});c.a.interceptors.request.use((function(e){var t=Se.state.auth.token;return t&&(e.headers["Authorization"]="Bearer ".concat(t)),e}),(function(e){return Promise.reject(e)})),c.a.interceptors.response.use((function(e){return e}),(function(e){var t=e.response.status;return 401===t&&(Se.state.auth.token="",o.a.remove("token"),Ie.push("login")),Promise.reject(e)})),a["a"].use(C["a"]);var De=[{path:"/",name:"home",component:N},{path:"/client/:clientId",name:"client",component:se},{path:"/addUser",name:"AddUser",component:fe},{path:"/login",name:"Login",component:xe},{path:"/logout",name:"Logout",component:Re}],Ae=new C["a"]({routes:De});Ae.beforeEach((function(e,t,r){if(Se.state.auth.token||o.a.get("token")&&"null"!==o.a.get("token")&&o.a.get("userID")&&"null"!==o.a.get("userID"))r();else{if(Se.state.denyAccess=!0,"/Login"===e.path)return r();r({path:"/Login"})}}));var Ie=Ae,Ue=r("f309");a["a"].use(Ue["a"]);var Ne=new Ue["a"]({theme:{themes:{light:{primary:"#569fd3",secondary:"#005595",accent:"#78496a",error:"#b32317",info:"#5f6062",success:"#8a8d35",warning:"#d06f1a"}}}}),Be=r("1dce"),Te=r.n(Be),Oe=r("a7fe"),Fe=r.n(Oe);a["a"].config.productionTip=!1,a["a"].use(Fe.a,c.a),a["a"].use(Te.a),a["a"].use(r("2ead")),new a["a"]({router:Ie,store:Se,vuetify:Ne,render:function(e){return e($)}}).$mount("#app")},"9b31":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));r("7db0");var a={methods:{getClientDisplayName:function(e){var t=this.$store.state.clients.find((function(t){return t.id===e}));if(t)return t.displayName},getSystemURIDisplayName:function(e){var t,r;for(var a in this.$store.state.systemURI){var s=void 0;if(Array.isArray(this.$store.state.systemURI[a].uri)?s=this.$store.state.systemURI[a].uri.find((function(t){return t===e})):this.$store.state.systemURI[a].uri===e&&(s=e),s){t=this.$store.state.systemURI[a].displayName,r=a;break}}return{name:t,id:r}}}}},e4ce:function(e,t,r){"use strict";(function(e){r("a4d3"),r("e01a"),r("d28b"),r("7db0"),r("a15b"),r("b0c0"),r("d3b7"),r("ac1f"),r("25f0"),r("3ca3"),r("466d"),r("1276"),r("9911"),r("ddb0");var a=r("9b31");r("2ead");t["a"]={mixins:[a["a"]],name:"Client",data:function(){return{advancedView:!1,outcomes:{0:"Success",4:"Minor Failure - Client Error",8:"Serious Failure - Server Error",12:"Major Failure - Server Crashed"},selected:"",matchEvents:[],matchRule:[],auditEvent:[],systems:{},primary_systems:[Object({NODE_ENV:"production",VUE_APP_CRUID_TAG:"5c827da5-4858-4f3d-a50c-62ece001efea",VUE_APP_BROKEN_MATCH_URL:"http://clientregistry.org/brokenMatch",VUE_APP_FHIR_ROOT:"http://localhost:8081/clientregistry",VUE_APP_BACKEND_SERVER:"https://localhost:3000/OCRUX",BASE_URL:"/crux/"}).VUE_APP_SYSTEM_OPENMRS],match_count:0,uid:"",breaks:[],unbreaks:[],matchRuleHeaders:[{text:"Field",value:"name"},{text:"Field Details",value:"details"}],match_headers:[{text:"Submitting System",value:"system"},{text:"Record ID",value:"id"},{text:"Surname",value:"family"},{text:"Given Name(s)",value:"given"},{text:"Gender",value:"gender"},{text:"Birth Date",value:"birthdate"}],match_items:[],break_items:[]}},mounted:function(){this.getPatient(),this.getAuditEvents()},methods:{getPatient:function(){var e=this;this.breaks=[],this.match_items=[],this.break_items=[],this.match_count=0,this.$http.get("/ocrux/fhir/Patient?_elements=link,extension&_id="+this.$route.params.clientId).then((function(t){var r=t.data.entry[0].resource.link[0].other.reference.split("/").pop(),a=t.data.entry[0].resource,s=[];if(a.extension){var n=!0,i=!1,o=void 0;try{for(var l,c=a.extension[Symbol.iterator]();!(n=(l=c.next()).done);n=!0){var u=l.value;"http://clientregistry.org/brokenMatch"===u.url&&s.push(u.valueReference.reference.split("/").pop())}}catch(d){i=!0,o=d}finally{try{n||null==c.return||c.return()}finally{if(i)throw o}}}s.length>0&&(s=s.join(","),e.$http.get("/ocrux/fhir/Patient?_id="+s).then((function(t){var r=!0,a=!1,s=void 0;try{for(var n,i=t.data.entry[Symbol.iterator]();!(r=(n=i.next()).done);r=!0){var o=n.value,l=o.resource,c=void 0,u=void 0,v=void 0,h=void 0,m=void 0;if(l.meta&&l.meta.tag){var p=!0,f=!1,y=void 0;try{for(var _,b=l.meta.tag[Symbol.iterator]();!(p=(_=b.next()).done);p=!0){var g=_.value;"clientid"===g.code&&(m=g.display)}}catch(d){f=!0,y=d}finally{try{p||null==b.return||b.return()}finally{if(f)throw y}}}u=e.getClientDisplayName(m);var k=[];if(l.identifier){var x=!0,w=!1,$=void 0;try{for(var C,V=l.identifier[Symbol.iterator]();!(x=(C=V.next()).done);x=!0){var E=C.value,R=e.getSystemURIDisplayName(E.system);R?("internalid"===R.id&&(c=E.value),k.push({name:R.name,value:E.value})):k.push({name:E.system,value:E.value})}}catch(d){w=!0,$=d}finally{try{x||null==V.return||V.return()}finally{if(w)throw $}}}try{v=l.name.find((function(e){return"official"===e.use}))}catch(d){v={family:"",given:[]}}try{h=l.telecom.find((function(e){return e.system="phone"})).value}catch(d){h=""}e.break_items.push({fid:l.id,system:u,id:c,gender:l.gender,birthdate:l.birthDate,name:l.name,telecom:l.telecom,identifier:k,family:v.family,given:v.given.join(" "),phone:h})}}catch(d){a=!0,s=d}finally{try{r||null==i.return||i.return()}finally{if(a)throw s}}}))),e.$http.get("/ocrux/fhir/Patient?_include=Patient:link&_id="+r).then((function(t){var r=!0,a=!1,s=void 0;try{for(var n,i=t.data.entry[Symbol.iterator]();!(r=(n=i.next()).done);r=!0){var o=n.value,l=o.resource;if(l.meta.tag&&void 0!==l.meta.tag.find((function(e){return"5c827da5-4858-4f3d-a50c-62ece001efea"===e.code})))e.uid=l.id;else{l.id===e.$route.params.clientId&&(e.selected=e.match_count);var c=void 0,u=void 0,v=void 0,h=void 0,m=void 0;if(l.meta&&l.meta.tag){var p=!0,f=!1,y=void 0;try{for(var _,b=l.meta.tag[Symbol.iterator]();!(p=(_=b.next()).done);p=!0){var g=_.value;"clientid"===g.code&&(m=g.display)}}catch(d){f=!0,y=d}finally{try{p||null==b.return||b.return()}finally{if(f)throw y}}}u=e.getClientDisplayName(m);var k=[];if(l.identifier){var x=!0,w=!1,$=void 0;try{for(var C,V=l.identifier[Symbol.iterator]();!(x=(C=V.next()).done);x=!0){var E=C.value,R=e.getSystemURIDisplayName(E.system);R&&R.name?("internalid"===R.id&&(c=E.value),k.push({name:R.name,value:E.value})):k.push({name:E.system,value:E.value})}}catch(d){w=!0,$=d}finally{try{x||null==V.return||V.return()}finally{if(w)throw $}}}try{v=l.name.find((function(e){return"official"===e.use}))}catch(d){v={family:"",given:[]}}try{h=l.telecom.find((function(e){return e.system="phone"})).value}catch(d){h=""}e.match_items.push({fid:l.id,selectIdx:e.match_count,system:u,id:c,gender:l.gender,birthdate:l.birthDate,name:l.name,telecom:l.telecom,identifier:k,family:v.family,given:v.given.join(" "),phone:h}),e.match_count++}}}catch(d){a=!0,s=d}finally{try{r||null==i.return||i.return()}finally{if(a)throw s}}}))}))},selectPatient:function(e){this.selected=e.selectIdx},breakMatch:function(){var e=this;if(this.breaks.length>0){var t=this.$store.state.auth.username,r="/ocrux/breakMatch?username=".concat(t),a=[],s=!0,n=!1,i=void 0;try{for(var o,l=this.breaks[Symbol.iterator]();!(s=(o=l.next()).done);s=!0){var c=o.value;a.push("Patient/"+c.fid)}}catch(u){n=!0,i=u}finally{try{s||null==l.return||l.return()}finally{if(n)throw i}}this.$http.post(r,a).then((function(t){e.getPatient(),e.getAuditEvents()}))}},revertBreak:function(){var e=this;if(this.unbreaks.length>0){var t=this.$store.state.auth.username,r="/ocrux/unBreakMatch?username=".concat(t),a=[],s=!0,n=!1,i=void 0;try{for(var o,l=this.unbreaks[Symbol.iterator]();!(s=(o=l.next()).done);s=!0){var c=o.value,u=!0,d=!1,v=void 0;try{for(var h,m=this.match_items[Symbol.iterator]();!(u=(h=m.next()).done);u=!0){var p=h.value;a.push({id2:"Patient/"+p.fid,id1:"Patient/"+c.fid})}}catch(f){d=!0,v=f}finally{try{u||null==m.return||m.return()}finally{if(d)throw v}}}}catch(f){n=!0,i=f}finally{try{s||null==l.return||l.return()}finally{if(n)throw i}}this.$http.post(r,a).then((function(t){e.getPatient(),e.getAuditEvents()}))}},getAuditEvents:function(){var t=this;this.matchEvents=[];var r="/ocrux/fhir/AuditEvent?entity=".concat(this.$route.params.clientId,"&entity-name=submittedResource,breakTo,breakFrom,unBreak,unBreakFromResource&_sort=-_lastUpdated");this.$http.get(r).then((function(r){t.auditEvent=r.data;var a=!0,s=!1,n=void 0;try{for(var i,o=r.data.entry[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var l=i.value,c={matchData:[]};c.recorded=l.resource.recorded;var u=l.resource.entity.find((function(e){return"break"===e.name||"breakFrom"===e.name})),d=l.resource.entity.find((function(e){return"unBreak"===e.name||"unBreakFromResource"===e.name})),v=void 0,h=!0,m=!1,p=void 0;try{for(var f,y=l.resource.subtype[Symbol.iterator]();!(h=(f=y.next()).done);h=!0){var _=f.value;"http://hl7.org/fhir/restful-interaction"===_.system&&(v=_.code)}}catch(Z){m=!0,p=Z}finally{try{h||null==y.return||y.return()}finally{if(m)throw p}}if(c.operation=v,c.outcomeCode=l.resource.outcome,c.outcome=t.outcomes[l.resource.outcome],c.outcomeDesc=l.resource.outcomeDesc,l.resource.agent&&Array.isArray(l.resource.agent)){var b=!0,g=!1,k=void 0;try{for(var x,w=l.resource.agent[Symbol.iterator]();!(b=(x=w.next()).done);b=!0){var $=x.value;$.altId&&(c.username=$.altId),$.network&&(c.ipaddress=$.network.address)}}catch(Z){g=!0,k=Z}finally{try{b||null==w.return||w.return()}finally{if(g)throw k}}}if(u){c.breakFrom=[],c.type="breakMatch";var C=!0,V=!1,E=void 0;try{for(var R,P=l.resource.entity[Symbol.iterator]();!(C=(R=P.next()).done);C=!0){var S=R.value;"break"===S.name&&(c.break=S.what.reference),"oldCRUID"===S.name&&(c.CRUID=S.what.reference),"breakFrom"===S.name&&c.breakFrom.push(S.what.reference)}}catch(Z){V=!0,E=Z}finally{try{C||null==P.return||P.return()}finally{if(V)throw E}}t.matchEvents.push(c)}else if(d){c.unBreakFrom=[],c.type="unBreak";var D=!0,A=!1,I=void 0;try{for(var U,N=l.resource.entity[Symbol.iterator]();!(D=(U=N.next()).done);D=!0){var B=U.value;"unBreak"===B.name&&(c.unBreak=B.what.reference),"unBreakFromCRUID"===B.name&&(c.unBreakFromCRUID=B.what.reference),"unBreakFromResource"===B.name&&c.unBreakFrom.push(B.what.reference)}}catch(Z){A=!0,I=Z}finally{try{D||null==N.return||N.return()}finally{if(A)throw I}}t.matchEvents.push(c)}else{var T=!0,O=!1,F=void 0;try{for(var q,M=l.resource.entity[Symbol.iterator]();!(T=(q=M.next()).done);T=!0){var j=q.value;if("submittedResource"===j.name){c.type="submittedResource",c.submittedResource=j.what.reference;var L=!0,H=!1,Y=void 0;try{for(var G,K=j.detail[Symbol.iterator]();!(L=(G=K.next()).done);L=!0){var z=G.value;if("resource"===z.type)c.submittedResourceData=z.valueString;else if("match"===z.type){var J=new e.from(z.valueBase64Binary,"base64").toString("ascii");J=JSON.parse(J);var X=[];for(var Q in J.rule.fields){var W=J.rule.fields[Q];X.push({name:Q,id:Q,details:W})}c.matchData.push({decisionRule:X,matchingType:J.rule.matchingType,filters:J.rule.filters,match:JSON.stringify(J.match,0,2),query:JSON.stringify(J.query,0,2)})}}}catch(Z){H=!0,Y=Z}finally{try{L||null==K.return||K.return()}finally{if(H)throw Y}}}}}catch(Z){O=!0,F=Z}finally{try{T||null==M.return||M.return()}finally{if(O)throw F}}t.matchEvents.push(c)}}}catch(Z){s=!0,n=Z}finally{try{a||null==o.return||o.return()}finally{if(s)throw n}}}))}}}}).call(this,r("b639").Buffer)}});
//# sourceMappingURL=app.f0a4910a.js.map